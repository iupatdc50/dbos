<?xml version="1.0"?><Report><ReportQuery><Format><ReportTitle>Activity Report and Daily Dues Collection</ReportTitle><ReportDescription>Monthly International Report.  Select export to CSV to make modifications in Excel</ReportDescription><PageSize>.DEFAULT</PageSize><PageOrientation>.DEFAULT</PageOrientation><TopMargin></TopMargin><BottomMargin></BottomMargin><RightMargin></RightMargin><LeftMargin></LeftMargin><pdfFont></pdfFont><pdfFontSize></pdfFontSize><PreExecuteCode>NONE</PreExecuteCode><formBetweenRows>solidline</formBetweenRows><gridDisplay>.DEFAULT</gridDisplay><gridSortable>.DEFAULT</gridSortable><gridSearchable>.DEFAULT</gridSearchable><gridPageable>.DEFAULT</gridPageable><gridPageSize>.DEFAULT</gridPageSize></Format><Datasource><SourceType>database</SourceType><SourceConnection><DatabaseType>mysql</DatabaseType><DatabaseName></DatabaseName><HostName></HostName><ServiceName></ServiceName><UserName></UserName><Password></Password></SourceConnection></Datasource><EntryForm><Query><TableSql></TableSql><WhereSql></WhereSql><GroupSql></GroupSql><RowSelection>all</RowSelection><SQL><QuerySql></QuerySql><SQLRaw>SELECT 
    DR.rate,
    CONCAT(Me.last_nm, COALESCE(CONCAT(', ', Me.suffix), ''), ', ', LEFT(Me.first_nm, 1)) AS member_name, 
    Me.report_id,
    CONCAT(
      CASE WHEN MeA.application_dt IS NOT NULL THEN 'Application ' ELSE '' END, 
      CASE WHEN MeI.init_dt IS NOT NULL THEN 'Initiated ' ELSE '' END, 
      CASE WHEN CS.member_status = 'S' THEN 'Suspended ' ELSE COALESCE(CS.REASON, '') END
    ) AS descrip,
    COALESCE(AA.received_dt, CS.effective_dt, MeA.application_dt, MeI.init_dt) AS received_dt,
    AA.receipt_id AS receipt_nbr,
    SUM(CASE WHEN AA.fee_type = 'DU' THEN AA.amt ELSE NULL END) AS dues,
    SUM(CASE WHEN AA.fee_type = 'DU' THEN AA.months ELSE NULL END) AS months,
    MAX(CASE WHEN AA.fee_type = 'DU' THEN AA.paid_thru_dt ELSE NULL END) AS paid_thru_dt,
    SUM(CASE WHEN AA.fee_type = 'CC' THEN AA.amt ELSE NULL END) AS cc,
    SUM(CASE WHEN AA.fee_type = 'RN' THEN AA.amt ELSE NULL END) AS reinst_fee,
    SUM(CASE WHEN AA.fee_type = 'IN' THEN AA.amt ELSE NULL END) AS init_fee,
    SUM(CASE WHEN AA.fee_type = 'MS' THEN AA.amt ELSE NULL END) AS misc,
    SUM(CASE WHEN AA.fee_type IN ('DU', 'CC', 'RN', 'IN', 'MS') THEN AA.amt ELSE NULL END) AS total
  FROM Members AS Me 
    LEFT OUTER JOIN AllocExtended AS AA ON AA.member_id = Me.member_id
                                       [  AND AA.acct_month = CONCAT(LEFT({report_month}, 4), SUBSTR({report_month}, 6, 2)) ]
                                         AND AA.fee_type IN ('DU', 'CC', 'RN', 'IN', 'MS')
    JOIN MemberStatuses AS MS ON MS.member_id = Me.member_id
	                           AND MS.effective_dt = (SELECT MAX(effective_dt) FROM MemberStatuses WHERE member_id = Me.member_id)
	  JOIN DuesRates AS DR ON DR.lob_cd = MS.lob_cd
	                        AND DR.rate_class = 'R'
	                        AND DR.end_dt IS NULL
	LEFT OUTER JOIN MemberStatuses AS CS ON CS.member_id = Me.member_id
	                                    AND (CS.member_status = 'S' OR CS.reason LIKE 'CC%' OR CS.reason LIKE '%drop%' OR CS.reason LIKE 'Forf%' OR CS.reason LIKE '%reinsta%')
	                                   [ AND CS.effective_dt BETWEEN CONCAT(LEFT({report_month}, 8), '01') AND {report_month} ]
	LEFT OUTER JOIN Members AS MeA ON MeA.member_id = Me.member_id
	                              [  AND MeA.application_dt BETWEEN CONCAT(LEFT({report_month}, 8), '01') AND {report_month}  ]
	LEFT OUTER JOIN Members AS MeI ON MeI.member_id = Me.member_id
	                                AND MeI.init_dt BETWEEN CONCAT(LEFT({report_month}, 8), '01') AND {report_month} ]
  WHERE 1 = 1 
   [ AND MS.lob_cd = {lob_cd} ]
  GROUP BY DR.rate, Me.last_nm, Me.suffix, Me.first_nm, Me.report_id, descrip, receipt_nbr
  HAVING TOTAL IS NOT NULL OR descrip &lt;&gt; ''
  ORDER BY Me.last_nm, Me.first_nm, AA.received_dt
;    
</SQLRaw></SQL><QueryColumns><QueryColumn><Name>rate</Name><TableName>DR</TableName><ColumnName>rate</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>show</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>right</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML></ColumnWidthHTML><column_title>Charges</column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn><QueryColumn><Name>member_name</Name><TableName></TableName><ColumnName>CONCAT(Me.last_nm, COALESCE(CONCAT(', ', Me.suffix), ''), ', ', LEFT(Me.first_nm, 1)) AS</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>show</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>left</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML></ColumnWidthHTML><column_title></column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn><QueryColumn><Name>report_id</Name><TableName>Me</TableName><ColumnName>report_id</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>show</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>left</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML></ColumnWidthHTML><column_title>Soc Sec No</column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn><QueryColumn><Name>descrip</Name><TableName></TableName><ColumnName>CONCAT(
      CASE WHEN MeA.application_dt IS NOT NULL THEN 'Application ' ELSE '' END, 
      CASE WHEN MeI.init_dt IS NOT NULL THEN 'Initiated ' ELSE '' END, 
      CASE WHEN CS.member_status = 'S' THEN 'Suspended ' ELSE COALESCE(CS.REASON, '') END
    ) AS</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>show</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>left</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML></ColumnWidthHTML><column_title>Actv Chg</column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn><QueryColumn><Name>received_dt</Name><TableName></TableName><ColumnName>COALESCE(AA.received_dt, CS.effective_dt, MeA.application_dt, MeI.init_dt) AS</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>show</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>left</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML></ColumnWidthHTML><column_title>Date</column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn><QueryColumn><Name>receipt_nbr</Name><TableName></TableName><ColumnName>AA.receipt_id AS</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>show</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>left</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML></ColumnWidthHTML><column_title>Receipt Number</column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn><QueryColumn><Name>dues</Name><TableName></TableName><ColumnName>SUM(CASE WHEN AA.fee_type = 'DU' THEN AA.amt ELSE NULL END) AS</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>show</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>right</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML></ColumnWidthHTML><column_title>Reg Dues</column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn><QueryColumn><Name>months</Name><TableName></TableName><ColumnName>SUM(CASE WHEN AA.fee_type = 'DU' THEN AA.months ELSE NULL END) AS</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>show</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>right</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML></ColumnWidthHTML><column_title>No Mos Pd</column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn><QueryColumn><Name>paid_thru_dt</Name><TableName></TableName><ColumnName>MAX(CASE WHEN AA.fee_type = 'DU' THEN AA.paid_thru_dt ELSE NULL END) AS</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>show</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>left</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML></ColumnWidthHTML><column_title>Incl Mo Of</column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn><QueryColumn><Name>cc</Name><TableName></TableName><ColumnName>SUM(CASE WHEN AA.fee_type = 'CC' THEN AA.amt ELSE NULL END) AS</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>show</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>right</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML></ColumnWidthHTML><column_title>Cl Card/W.D. Card</column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn><QueryColumn><Name>reinst_fee</Name><TableName></TableName><ColumnName>SUM(CASE WHEN AA.fee_type = 'RN' THEN AA.amt ELSE NULL END) AS</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>show</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>right</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML></ColumnWidthHTML><column_title>Reinst Fees</column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn><QueryColumn><Name>init_fee</Name><TableName></TableName><ColumnName>SUM(CASE WHEN AA.fee_type = 'IN' THEN AA.amt ELSE NULL END) AS</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>show</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>right</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML></ColumnWidthHTML><column_title>Proc. Fee</column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn><QueryColumn><Name>misc</Name><TableName></TableName><ColumnName>SUM(CASE WHEN AA.fee_type = 'MS' THEN AA.amt ELSE NULL END) AS</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>show</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>right</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML></ColumnWidthHTML><column_title>Misc Chg</column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn><QueryColumn><Name>total</Name><TableName></TableName><ColumnName>SUM(CASE WHEN AA.fee_type IN ('DU', 'CC', 'RN', 'IN', 'MS') THEN AA.amt ELSE NULL END) AS</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>show</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>right</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML></ColumnWidthHTML><column_title>Total Rec'd</column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn></QueryColumns><OrderColumns></OrderColumns><PreSQLS></PreSQLS></Query><Assignments><Assignment><AssignName>paid_thru_dt</AssignName><AssignNameNew></AssignNameNew><Expression>date('M Y', strtotime({paid_thru_dt}))</Expression><Condition>null != {paid_thru_dt}</Condition></Assignment><Assignment><AssignName>received_dt</AssignName><AssignNameNew></AssignNameNew><Expression>date('m/d/y', strtotime({received_dt}))</Expression><Condition></Condition></Assignment></Assignments><Criteria><CriteriaItem><Name>lob_cd</Name><Title>Trade</Title><QueryTableName></QueryTableName><QueryColumnName></QueryColumnName><CriteriaType>LOOKUP</CriteriaType><CriteriaHelp>Choose trade to be included in report</CriteriaHelp><CriteriaDisplay>DROPDOWN</CriteriaDisplay><ExpandDisplay>NOINPUT</ExpandDisplay><CriteriaRequired>yes</CriteriaRequired><CriteriaHidden>.DEFAULT</CriteriaHidden><CriteriaDisplayGroup></CriteriaDisplayGroup><ReturnColumn>lob_cd</ReturnColumn><DisplayColumn>descrip</DisplayColumn><OverviewColumn>lob_cd</OverviewColumn><MatchColumn>lob_cd</MatchColumn><CriteriaDefaults>1791</CriteriaDefaults><CriteriaList></CriteriaList><Query><TableSql></TableSql><WhereSql></WhereSql><GroupSql></GroupSql><RowSelection></RowSelection><SQLRaw>SELECT lob_cd, descrip
FROM  Lobs
WHERE 1 = 1 
</SQLRaw><SQL><QuerySql></QuerySql></SQL><QueryColumns><QueryColumn><Name>lob_cd</Name><TableName></TableName><ColumnName>lob_cd</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>show</column_display><content_type>plain</content_type><justify>left</justify></Format></QueryColumn><QueryColumn><Name>descrip</Name><TableName></TableName><ColumnName>descrip</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>show</column_display><content_type>plain</content_type><justify>left</justify></Format></QueryColumn></QueryColumns><OrderColumns></OrderColumns><Assignments></Assignments></Query><CriteriaLinks></CriteriaLinks></CriteriaItem><CriteriaItem><Name>report_month</Name><Title>Acct Month End</Title><QueryTableName></QueryTableName><QueryColumnName></QueryColumnName><CriteriaType>DATE</CriteriaType><CriteriaHelp>Enter accounting month ending date</CriteriaHelp><CriteriaDisplay>NOINPUT</CriteriaDisplay><ExpandDisplay>NOINPUT</ExpandDisplay><CriteriaRequired>.DEFAULT</CriteriaRequired><CriteriaHidden>.DEFAULT</CriteriaHidden><CriteriaDisplayGroup></CriteriaDisplayGroup><ReturnColumn></ReturnColumn><DisplayColumn></DisplayColumn><OverviewColumn></OverviewColumn><MatchColumn></MatchColumn><CriteriaDefaults>LASTOFLASTMONTH</CriteriaDefaults><CriteriaList></CriteriaList><Query><TableSql></TableSql><WhereSql></WhereSql><GroupSql></GroupSql><RowSelection></RowSelection><SQLRaw></SQLRaw><SQL><QuerySql></QuerySql></SQL><QueryColumns></QueryColumns><OrderColumns></OrderColumns><Assignments></Assignments></Query><CriteriaLinks></CriteriaLinks></CriteriaItem></Criteria><Output><PageHeaders></PageHeaders><PageFooters></PageFooters><DisplayOrders><DisplayOrder><ColumnName>rate</ColumnName><OrderNumber>1</OrderNumber></DisplayOrder><DisplayOrder><ColumnName>member_name</ColumnName><OrderNumber>2</OrderNumber></DisplayOrder><DisplayOrder><ColumnName>report_id</ColumnName><OrderNumber>3</OrderNumber></DisplayOrder><DisplayOrder><ColumnName>received_dt</ColumnName><OrderNumber>4</OrderNumber></DisplayOrder><DisplayOrder><ColumnName>descrip</ColumnName><OrderNumber>5</OrderNumber></DisplayOrder><DisplayOrder><ColumnName>receipt_nbr</ColumnName><OrderNumber>6</OrderNumber></DisplayOrder><DisplayOrder><ColumnName>months</ColumnName><OrderNumber>7</OrderNumber></DisplayOrder><DisplayOrder><ColumnName>paid_thru_dt</ColumnName><OrderNumber>8</OrderNumber></DisplayOrder><DisplayOrder><ColumnName>dues</ColumnName><OrderNumber>9</OrderNumber></DisplayOrder><DisplayOrder><ColumnName>cc</ColumnName><OrderNumber>10</OrderNumber></DisplayOrder><DisplayOrder><ColumnName>reinst_fee</ColumnName><OrderNumber>11</OrderNumber></DisplayOrder><DisplayOrder><ColumnName>init_fee</ColumnName><OrderNumber>12</OrderNumber></DisplayOrder><DisplayOrder><ColumnName>misc</ColumnName><OrderNumber>13</OrderNumber></DisplayOrder><DisplayOrder><ColumnName>total</ColumnName><OrderNumber>14</OrderNumber></DisplayOrder></DisplayOrders><Groups></Groups><Graphs></Graphs></Output></EntryForm></ReportQuery></Report>